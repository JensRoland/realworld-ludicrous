(()=>{if(document.__boosti)return;document.__boosti=!0,document.__fixi_mo||(document.__fixi_mo=new MutationObserver(e=>e.forEach(n=>n.type==="childList"&&n.addedNodes.forEach(o=>h(o)))));let f=(e,n,o,s)=>e.dispatchEvent(new CustomEvent("fx:"+n,{detail:o,cancelable:!0,bubbles:s!==!1,composed:!0})),l=(e,n,o)=>e.getAttribute(n)||o,w=e=>e.closest("[fx-ignore]")!=null,y=e=>e.split(/\s*,\s*/).map(n=>{let o=n.trim().split(/\s+/),s={evt:o[0]};for(let r=1;r<o.length;r++){let i=o[r];i==="changed"?s.changed=!0:i==="once"?s.once=!0:i.startsWith("delay:")?s.delay=parseInt(i.slice(6)):i.startsWith("throttle:")?s.throttle=parseInt(i.slice(9)):i.startsWith("threshold:")&&(s.threshold=parseFloat(i.slice(10)))}return s}),E=(e,n,o)=>{let s=n.changed?o.value:void 0,r,i=0;return a=>{if(n.changed){let d=o.value;if(d===s)return;s=d}let c=()=>e(a);if(n.throttle){let d=Date.now(),t=n.throttle-(d-i);t<=0?(i=d,c()):r||(r=setTimeout(()=>{r=null,i=Date.now(),c()},t))}else n.delay?(clearTimeout(r),r=setTimeout(c,n.delay)):c()}},g=e=>{let n={};if(e.__fixi||w(e)||!f(e,"init",{options:n}))return;e.__fixi=async r=>{let i=e.__fixi.requests||=new Set,a=e.form||e.closest("form"),c=new FormData(a??void 0,r.submitter);!a&&e.name&&c.append(e.name,e.value);let d=new AbortController,t={trigger:r,action:l(e,"fx-action"),method:l(e,"fx-method","GET").toUpperCase(),target:document.querySelector(l(e,"fx-target"))??e,swap:l(e,"fx-swap","outerHTML"),body:c,drop:i.size,headers:{"FX-Request":"true"},abort:d.abort.bind(d),signal:d.signal,preventTrigger:!0,transition:document.startViewTransition?.bind(document),fetch:fetch.bind(window)},x=e.getAttribute("fx-confirm");x&&(t.confirm=()=>Promise.resolve(confirm(x)));let _=f(e,"config",{cfg:t,requests:i});if(t.preventTrigger&&r.preventDefault(),!_||t.drop)return;if(/GET|DELETE/.test(t.method)){let m=new URLSearchParams(t.body);m.size&&(t.action+=(/\?/.test(t.action)?"&":"?")+m),t.body=null}i.add(t);let p=document.querySelector(l(e,"fx-indicator"));p&&p.classList.add("fx-request");try{if(t.confirm&&!await t.confirm()||!f(e,"before",{cfg:t,requests:i})||(t.response=await t.fetch(t.action,t),t.text=await t.response.text(),!f(e,"after",{cfg:t})))return}catch(m){f(e,"error",{cfg:t,error:m});return}finally{i.delete(t),p&&p.classList.remove("fx-request"),f(e,"finally",{cfg:t})}let v=()=>{if(t.swap instanceof Function)return t.swap(t);if(/(before|after)(begin|end)/.test(t.swap))t.target.insertAdjacentHTML(t.swap,t.text);else if(t.swap in t.target)t.target[t.swap]=t.text;else if(t.swap!=="none")throw t.swap};t.transition?await t.transition(v).finished:await v(),f(e,"swapped",{cfg:t}),document.contains(e)||f(document,"swapped",{cfg:t}),e.hasAttribute("fx-reset")&&t.response.ok&&a&&a.reset()};let o=l(e,"fx-trigger",e.matches("form")?"submit":e.matches("input:not([type=button]),select,textarea")?"change":"click"),s=y(o);e.__fixi.evt=s.map(r=>r.evt).join(", ");for(let r of s){let i=E(e.__fixi,r,e);if(r.evt==="intersect"){let a=!1,c=new IntersectionObserver(d=>{d[0].isIntersecting&&!a&&(a=!0,i(new CustomEvent("intersect")),r.once&&c.disconnect())},{threshold:r.threshold||0});c.observe(e),requestAnimationFrame(()=>{!a&&e.getBoundingClientRect().top<window.innerHeight&&(a=!0,i(new CustomEvent("intersect")),r.once&&c.disconnect())})}else e.addEventListener(r.evt,i,r.once?{...n,once:!0}:n)}f(e,"inited",{},!1)},h=e=>{if(e.matches){if(w(e))return;e.matches("[fx-action]")&&g(e)}e.querySelectorAll&&e.querySelectorAll("[fx-action]").forEach(g)};document.addEventListener("fx:process",e=>h(e.target));function T(e){const n=document.head,o=new Map;for(const r of e.children)o.set(r.outerHTML,r);const s=[];for(const r of n.children){const i=r.outerHTML;o.has(i)?o.delete(i):r.hasAttribute("fx-preserve")||s.push(r)}for(const r of o.values())n.appendChild(document.createRange().createContextualFragment(r.outerHTML));for(const r of s)r.remove()}async function u(e,n){try{const o=await fetch(e,n);if(o.redirected)return u(o.url,{method:"GET"});const s=await o.text(),r=new DOMParser().parseFromString(s,"text/html"),i=()=>{document.title=r.title,T(r.head),document.body.replaceWith(r.body.cloneNode(!0)),window.scrollTo(0,0),h(document.body)};document.startViewTransition?await document.startViewTransition(i).finished:i(),(!n||n.method==="GET")&&history.pushState({},"",e)}catch{location.href=e}}function b(e){return!e.closest('[fx-boost="false"]')}document.addEventListener("click",e=>{const n=e.target.closest('a[href^="/"]');!n||n.hasAttribute("fx-action")||!b(n)||e.ctrlKey||e.metaKey||e.shiftKey||(e.preventDefault(),u(n.href,{method:"GET"}))}),document.addEventListener("submit",e=>{const n=e.target;if(n.hasAttribute("fx-action")||!b(n))return;e.preventDefault();const o=(n.method||"GET").toUpperCase(),s=n.action||location.href;if(o==="GET"){const r=new URLSearchParams(new FormData(n));u(s+(s.includes("?")?"&":"?")+r,{method:"GET"})}else u(s,{method:o,body:new FormData(n)})}),window.addEventListener("popstate",()=>u(location.href,{method:"GET"})),document.addEventListener("DOMContentLoaded",()=>{document.__fixi_mo.observe(document.documentElement,{childList:!0,subtree:!0}),h(document.body)})})();
